<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


  
  <mapper namespace="Files">
  
  	<insert id="insert">
  	
  		INSERT INTO FILES VALUES(files_seq.nextval, #{oriName},#{sysName},#{parentSeq})
  		
  	</insert>
  	
   	<select id ="selectBySeq" resultType="kh.spring.dto.FilesDTO">
  	
  		SELECT * FROM FILES WHERE parentSeq = #{seq}
  	</select> 
  	
  	<select id ="selectAll" resultType="kh.spring.dto.FilesDTO">
  	
  		 SELECT * FROM FILES WHERE SEQ IN (SELECT MIN(SEQ) FROM FILES GROUP BY PARENTSEQ)
  	</select>
  	
  	<select id = "NameToSeq" resultType="kh.spring.dto.FilesDTO">
  	SELECT * FROM FILES WHERE SEQ IN (SELECT MIN(SEQ) FROM FILES WHERE SEQ IN
  	<foreach collection="NameToSeq" index="index" item="items" open="(" close=")" separator=",">
 		 #{items.iseq}
 		
 		</foreach>
 		GROUP BY PARENTSEQ)
  	</select>
  	
  	
  	
  		<select id="selectMineById" resultType="kh.spring.dto.FilesDTO"> 
  	SELECT  F.* 
FROM ITEMS I  INNER JOIN FILES F ON(I.ISEQ =F.PARENTSEQ)
WHERE SELLERID =#{id} AND  SEQ IN (SELECT MIN(SEQ) FROM FILES GROUP BY PARENTSEQ)
  	
  	</select>
  	
  	<!-- <select id ="selectBySeqListing" resultType="kh.spring.dto.FilesDTO">
  	
  		 SELECT * FROM FILES WHERE PARENTSEQ = #{parentSeq}
  	</select> -->
  	  
  	  
  <!-- <![CDATA[ ROWNUM = 1 ]]> -->
  
  </mapper>



